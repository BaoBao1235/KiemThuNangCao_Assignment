name: .NET Framework CI with NUnit

on:
  push:
    branches: [ master, main ]
  pull_request:
    branches: [ master, main ]

jobs:
  build:
    runs-on: windows-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup MSBuild
        uses: microsoft/setup-msbuild@v2

      - name: Setup NuGet
        uses: NuGet/setup-nuget@v2

      - name: Restore NuGet packages
        run: nuget restore PRO231-DuAnTotNghiep.sln

      # üß± Build to√†n b·ªô solution (bao g·ªìm DuAnTotNghiep.Test)
      - name: Build solution (include test project)
        run: msbuild PRO231-DuAnTotNghiep.sln /p:Configuration=Release /p:Platform="Any CPU"

      # üß© In ra danh s√°ch th∆∞ m·ª•c build ƒë·ªÉ ki·ªÉm tra file .dll th·ª±c t·∫ø
      - name: Show directory structure for debugging
        run: |
          dir
          dir .\DuAnTotNghiep.Test
          dir .\DuAnTotNghiep.Test\bin
          dir .\DuAnTotNghiep.Test\bin\Release

      # ‚úÖ C√†i NUnit Console Runner
      - name: Download NUnit Console Runner
        run: nuget install NUnit.ConsoleRunner -Version 3.16.3 -OutputDirectory testrunner

      # ‚úÖ Ch·∫°y test (v·ªõi ƒë∆∞·ªùng d·∫´n tuy·ªát ƒë·ªëi an to√†n)
      - name: Run NUnit Tests
        run: |
          ./testrunner/NUnit.ConsoleRunner.3.16.3/tools/nunit3-console.exe "$(Resolve-Path .\DuAnTotNghiep.Test\bin\Release\DuAnTotNghiep.Test.dll)"
