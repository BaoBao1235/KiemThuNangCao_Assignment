stages:
  - build
  - test

variables:
  DOTNET_VERSION: "8.0"   # ??i n?u b?n ?ang dùng .NET 6 ho?c 7

before_script:
  - 'echo Using .NET version $DOTNET_VERSION'
  - 'apt-get update -y'
  - 'apt-get install -y wget apt-transport-https'
  - 'wget https://packages.microsoft.com/config/debian/12/packages-microsoft-prod.deb -O packages-microsoft-prod.deb'
  - 'dpkg -i packages-microsoft-prod.deb'
  - 'apt-get update -y'
  - 'apt-get install -y dotnet-sdk-$DOTNET_VERSION'

build_job:
  stage: build
  script:
    - 'dotnet restore'
    - 'dotnet build --configuration Release'
  artifacts:
    paths:
      - bin/

test_job:
  stage: test
  script:
    - 'dotnet test --configuration Release --logger "trx;LogFileName=test_results.trx"'
  artifacts:
    when: always
    paths:
      - '**/TestResults/*.trx'
